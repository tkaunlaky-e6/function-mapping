{
  "function": "FACTORIAL",
  "dialect": "spark",
  "parameter_analysis": {
    "n": {
      "real_domain": "INTEGER (INT, BIGINT) ∪ {NULL} ∪ {STRING, DECIMAL with implicit cast}",
      "partitions": [
        {
          "name": "P_NULL",
          "predicate": "n IS NULL",
          "representative": "NULL",
          "reasoning": "NULL propagation — standard SQL NULL handling"
        },
        {
          "name": "P_NEGATIVE",
          "predicate": "n IS NOT NULL AND n < 0",
          "representative": "-5",
          "reasoning": "Factorial undefined for negative integers — returns NULL"
        },
        {
          "name": "P_ZERO",
          "predicate": "n IS NOT NULL AND n = 0",
          "representative": "0",
          "reasoning": "Mathematical base case: 0! = 1"
        },
        {
          "name": "P_ONE",
          "predicate": "n IS NOT NULL AND n = 1",
          "representative": "1",
          "reasoning": "Mathematical base case: 1! = 1"
        },
        {
          "name": "P_SMALL_POS",
          "predicate": "n IS NOT NULL AND 2 ≤ n ≤ 10",
          "representative": "2, 5, 10",
          "reasoning": "Small positive integers with standard factorial computation — multiple representatives for coverage"
        },
        {
          "name": "P_LARGE_POS",
          "predicate": "n IS NOT NULL AND 11 ≤ n ≤ 20",
          "representative": "15, 20",
          "reasoning": "Large positive integers within valid range — 20 is the maximum before overflow"
        },
        {
          "name": "P_OVERFLOW",
          "predicate": "n IS NOT NULL AND n = 21",
          "representative": "21",
          "reasoning": "Overflow boundary — 21! exceeds BIGINT max value"
        },
        {
          "name": "P_LARGE_OVERFLOW",
          "predicate": "n IS NOT NULL AND n > 21",
          "representative": "100",
          "reasoning": "Well beyond overflow threshold — returns NULL"
        },
        {
          "name": "P_STRING",
          "predicate": "n is STRING type castable to INT",
          "representative": "'5'",
          "reasoning": "Implicit type conversion — string to integer cast"
        },
        {
          "name": "P_DECIMAL",
          "predicate": "n is DECIMAL type castable to INT",
          "representative": "5.5",
          "reasoning": "Implicit type conversion with truncation — decimal to integer cast"
        }
      ],
      "spanning_proof": "The real domain is: ℤ ∪ {NULL} ∪ {castable types: STRING, DECIMAL}. Partitions: {NULL} ∪ {n<0} ∪ {0} ∪ {1} ∪ [2,10] ∪ [11,20] ∪ {21} ∪ (21,+∞) ∪ {STRING} ∪ {DECIMAL}. Union covers: NULL + all integers (negative, zero, one, positive) + castable types. No integer or castable type falls outside these partitions. SPAN COMPLETE."
    }
  },
  "output_analysis": {
    "range": "R(FACTORIAL) = {NULL} ∪ {1} ∪ {n! : n ∈ [2,20], n ∈ ℤ}",
    "type_bounds": "BIGINT or NULL",
    "value_bounds": "output ≥ 1 when not NULL; max valid output is 20! = 2432902008176640000",
    "special_properties": [
      "0! = 1 and 1! = 1 by mathematical definition",
      "n! undefined for n < 0 → returns NULL",
      "n! overflows for n > 20 → returns NULL",
      "Implicit type casting from STRING and DECIMAL to INT"
    ],
    "codomain_classes": [
      {
        "name": "O_NULL",
        "predicate": "output IS NULL",
        "reasoning": "Null propagation, negative input, or overflow (n>20)",
        "covered_by": ["query 1: NULL input", "query 2: negative input", "query 10: overflow at 21", "query 11: large overflow"]
      },
      {
        "name": "O_ONE",
        "predicate": "output = 1",
        "reasoning": "Base cases: 0! = 1 and 1! = 1",
        "covered_by": ["query 3: 0! = 1", "query 4: 1! = 1"]
      },
      {
        "name": "O_SMALL_FACTORIAL",
        "predicate": "output ∈ [2, 3628800]",
        "reasoning": "Factorials from 2! to 10! — small to medium magnitude",
        "covered_by": ["query 5: 2! = 2", "query 6: 5! = 120", "query 7: 10! = 3628800", "query 12: string cast", "query 13: decimal cast"]
      },
      {
        "name": "O_LARGE_FACTORIAL",
        "predicate": "output > 3628800",
        "reasoning": "Factorials from 11! to 20! — large magnitude within valid range",
        "covered_by": ["query 8: 15! = 1307674368000", "query 9: 20! = 2432902008176640000"]
      }
    ],
    "surjectivity": {
      "total_classes": 4,
      "covered_classes": 4,
      "coverage_ratio": 1.0,
      "status": "COMPLETE"
    }
  },
  "basis_statistics": {
    "total_queries": 13,
    "total_partitions": 10,
    "total_codomain_classes": 4,
    "spanning_complete": true,
    "surjectivity_complete": true,
    "basis_minimal": true,
    "redundancy": "Zero — each query represents a distinct partition or provides necessary codomain coverage"
  },
  "completeness_proof": {
    "input_spanning": "PROVEN — All partitions {P_NULL, P_NEGATIVE, P_ZERO, P_ONE, P_SMALL_POS, P_MEDIUM_POS, P_LARGE_POS, P_OVERFLOW, P_LARGE_OVERFLOW, P_STRING, P_DECIMAL} cover the entire real domain ℤ ∪ {NULL} ∪ {castable types}. No input falls outside these partitions.",
    "output_surjectivity": "PROVEN — All 4 codomain classes {O_NULL, O_ONE, O_SMALL_FACTORIAL, O_LARGE_FACTORIAL} are covered by at least one query. Coverage = 4/4 = 1.0.",
    "mathematical_completeness": "COMPLETE — Both spanning and surjectivity conditions satisfied. The basis is minimal (no redundancy) and complete (no gaps)."
  },
  "notes": [
    "FACTORIAL in Spark SQL accepts only integer types (or types implicitly castable to integer)",
    "The function returns NULL for: NULL input, negative integers, and integers > 20 (overflow)",
    "Maximum valid input is 20; 21! exceeds BIGINT max value (9223372036854775807)",
    "String and decimal types are implicitly cast to INT (decimal values are truncated)",
    "The basis includes multiple representatives for P_SMALL_POS and P_LARGE_POS to ensure both small-magnitude and large-magnitude factorials are tested",
    "Type rejection cases (BOOLEAN, DATE, ARRAY) cause compile-time errors and are not part of the runtime domain"
  ]
}
